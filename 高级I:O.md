#### 非阻塞I/O

* 系统调用分为低速系统调用和其他，低速系统调用可能会使得进程永远阻塞的一类系统调用。
* 非阻塞I / O使我们可以调用不会永远阻塞的 I/O操作，例如open，read和write。如果这种操作不能完成，则立即出错返回，表示该操作如继续执行将继续阻塞下去。

#### 记录锁

有时进程需要确保它正在单独写一个文件。为了向进程提供这种功能，较新的 UNIX系统提供了记录锁机制。记录锁（ record locking）的功能是：一个进程正在读或修改文件的某个部分时，可以阻止
其他进程修改同一文件区。

两种类型的锁：共享读锁（l_type为L_RDLCK）和独占写琐（ L_WRLCK）。

多个进程在一个给定的字节上可以有一把共享的读锁，但是在一个给定字节上的写锁则只能由一个进程独用。

在这两个操作之间可能会有另一个进程插入并建立一把相关的锁，使原来测试到的情况发生变化，如果不希望在建立锁时可能产生的长期阻塞，则应使用F_SETLK，并对返回结果进行测试，以判别是否成功地建立了所要求的锁。

* 锁的隐含继承和释放：
  * 锁与进程、文件两方面有关。这有两重含意：第一重很明显，当一个进程终止时，它所建立的锁全部释放；第二重意思就不很明显，任何时候关闭一个描述符时，则该进程通过这一描述符可以存访的文件上的任何一把锁都被释放。
* 防止一个精灵进程有多份副本同时运行的方法是：在精灵进程开始运行时，在它的进程I D文件上设置一把写锁。如果在它运行时一直保持这把锁，则不可能再起动它的其他副本。
* ​