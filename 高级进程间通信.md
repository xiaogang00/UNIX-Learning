流管道是一个双向（全双工）管道。单个流管道就能向父、子进程提供双向的数据流。

s_pipe函数定义为与标准 pipe函数类似。它的调用参数与pipe相同，但返回的描述符以读 -写方式打开。

在进程间传送打开文件描述符的能力非常有用。用此可以对客户机 /服务器应用进行不同的设计。它允许一个进程（一般是服务器）处理与打开一个文件有关的所有操作。

当一个进程（通常是服务器）希望将一个描述符传送给另一个进程时，它调用 send_fd或send_err。等待接收描述符的进程（客户机）调用 recv_fd。

#### open服务器第一版

目前，使用文件描述符传送技术开发了一个 o p e n服务器：它是一个可执行程序，由一个进程执行以打开一个或多个文件。该服务器不是将文件送回调用进程，而是送回一个打开文件描述符。

这也意味着，用 IPC交换最小量的信息—从客户机到服务器传送文件名和打开方式，而从服务器到客户机返回描述符。文件内容则不需用 IPC传送。

将服务器设计成一个单独的可执行程序有很多优点：

1. 任一客户机都易于和服务器联系，这类似于客户机调用一库函数。不需要将一特定服务编码在应用程序中，而是设计一种可供重用的设施。
2. 如若需要更改服务器，那么也只影响一个程序。相反，更新一库函数可能要更改调用此库函数的所有程序（用连编程序重新连接）。共享库函数可以简化这种更新。
3. 服务器可以是设置 -用户- I D程序，于是使其具有客户机没有的附加许可权。注意，一个库函数（或共享库函数）不能提供这种能力。

客户机创建一流管道，然后调用fork和exec以调用服务器。客户机经流管道发送请求，服务器经管道回送响应。定义客户机和服务器间的协议如下：

1. 客户机经流管道向服务器发送下列形式的请求：

   open < pathname> <openmode> \ 0

   <openmode>是open函数的第二个参数，以十进制表示。该请求字符串以 null字节结尾。

2. 服务器调用send_fd 或send_err回送一打开描述符或一条出错消息。

客户机请求是一个空的中断的字符串，其参数由空格分隔。buf_args函数将字符串分解成标准argv型参数表，并调用用户函数处理参数。

#### 客户机-服务器连接函数

对于相关进程（例如，父进程和子进程）之间的IPC，流管道非常有用。前节所述的open服务器使用未命名的流管道能从子进程向父进程传送文件描述符。但是当处理无关进程时（例如，若服务器是一精灵进程），则需要使用有名的流管道。

